<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIÈßÜÂãïÈñãÁô∫„Çª„Éü„Éä„Éº - „Çπ„É©„Ç§„Éâ„Éì„É•„Éº„Ç¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', sans-serif;
            background: #1a1a2e;
            color: #fff;
            min-height: 100vh;
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        .header {
            background: #16213e;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 1.2rem;
            color: #e94560;
        }

        .header-nav {
            display: flex;
            gap: 1rem;
        }

        .header-nav button {
            background: #0f3460;
            border: none;
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .header-nav button:hover {
            background: #e94560;
        }

        .header-nav button.active {
            background: #e94560;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä */
        .container {
            display: flex;
            height: calc(100vh - 60px);
        }

        /* „Çµ„Ç§„Éâ„Éê„ÉºÔºàÁõÆÊ¨°Ôºâ */
        .sidebar {
            width: 300px;
            background: #16213e;
            overflow-y: auto;
            transition: transform 0.3s;
            border-right: 1px solid #0f3460;
        }

        .sidebar.hidden {
            transform: translateX(-300px);
            width: 0;
        }

        .toc-section {
            border-bottom: 1px solid #0f3460;
        }

        .toc-section-title {
            padding: 1rem;
            background: #0f3460;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toc-section-title:hover {
            background: #1a4a7a;
        }

        .toc-items {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s;
        }

        .toc-items.expanded {
            max-height: 2000px;
        }

        .toc-item {
            padding: 0.5rem 1rem 0.5rem 2rem;
            cursor: pointer;
            font-size: 0.85rem;
            border-left: 3px solid transparent;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .toc-item:hover {
            background: #1a4a7a;
        }

        .toc-item.active {
            background: #0f3460;
            border-left-color: #e94560;
        }

        .toc-item.section-title {
            font-weight: bold;
            color: #e94560;
        }

        /* „Çπ„É©„Ç§„Éâ„Éì„É•„Éº„Ç¢ */
        .viewer {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            position: relative;
        }

        .slide-container {
            max-width: 100%;
            max-height: calc(100vh - 200px);
            aspect-ratio: 16 / 9;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .slide-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .nav-controls {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .nav-btn {
            background: #0f3460;
            border: none;
            color: #fff;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn:hover:not(:disabled) {
            background: #e94560;
            transform: scale(1.1);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .slide-info {
            text-align: center;
            min-width: 200px;
        }

        .slide-title {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .slide-counter {
            font-size: 0.85rem;
            color: #888;
        }

        /* „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº */
        .progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: #0f3460;
        }

        .progress-fill {
            height: 100%;
            background: #e94560;
            transition: width 0.3s;
        }

        /* „Ç≠„Éº„Éú„Éº„Éâ„Éí„É≥„Éà */
        .keyboard-hint {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 0.75rem;
            color: #666;
        }

        /* „Çπ„Éî„Éº„Ç´„Éº„Éé„Éº„Éà */
        .notes-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #16213e;
            border-top: 2px solid #e94560;
            height: 40vh;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 500;
        }

        .notes-panel.visible {
            transform: translateY(0);
        }

        .notes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background: #0f3460;
            border-bottom: 1px solid #1a4a7a;
        }

        .notes-header h3 {
            font-size: 0.9rem;
            color: #e94560;
            margin: 0;
        }

        .notes-close {
            background: none;
            border: none;
            color: #888;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.25rem;
        }

        .notes-close:hover {
            color: #fff;
        }

        .notes-content {
            padding: 1rem;
            overflow-y: auto;
            height: calc(40vh - 50px);
            font-size: 0.9rem;
            line-height: 1.6;
            color: #ccc;
            white-space: pre-wrap;
        }

        .notes-btn {
            background: #0f3460;
            border: none;
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .notes-btn:hover {
            background: #e94560;
        }

        .notes-btn.active {
            background: #e94560;
        }

        /* „É≠„Éº„Éá„Ç£„É≥„Ç∞ */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid #0f3460;
            border-top-color: #e94560;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ - „Çø„Éñ„É¨„ÉÉ„Éà */
        @media (max-width: 768px) {
            .header {
                padding: 0.75rem 1rem;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .header h1 {
                font-size: 1rem;
                width: 100%;
                text-align: center;
            }

            .header-nav {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .header-nav button {
                padding: 0.4rem 0.6rem;
                font-size: 0.8rem;
            }

            .container {
                height: calc(100vh - 100px);
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                z-index: 1000;
                height: 100vh;
                width: 280px;
                transform: translateX(-100%);
            }

            .sidebar.visible {
                transform: translateX(0);
            }

            .sidebar.hidden {
                transform: translateX(-100%);
                width: 280px;
            }

            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 999;
            }

            .sidebar-overlay.visible {
                display: block;
            }

            .viewer {
                padding: 1rem;
            }

            .slide-container {
                max-height: calc(100vh - 220px);
            }

            .nav-controls {
                gap: 1rem;
                margin-top: 1rem;
            }

            .slide-info {
                min-width: 120px;
            }

            .slide-title {
                font-size: 0.85rem;
            }

            .slide-counter {
                font-size: 0.75rem;
            }

            .keyboard-hint {
                display: none;
            }
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ - „Çπ„Éû„Éº„Éà„Éï„Ç©„É≥ */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 0.9rem;
            }

            .header-nav button {
                padding: 0.35rem 0.5rem;
                font-size: 0.7rem;
            }

            .header-nav button#toc-btn {
                order: -1;
            }

            .container {
                height: calc(100vh - 110px);
            }

            .viewer {
                padding: 0.5rem;
            }

            .slide-container {
                max-height: calc(100vh - 200px);
                border-radius: 4px;
            }

            .nav-controls {
                gap: 0.5rem;
                margin-top: 0.75rem;
            }

            .nav-btn {
                width: 44px;
                height: 44px;
                font-size: 1.2rem;
            }

            .slide-info {
                min-width: 100px;
            }

            .slide-title {
                font-size: 0.75rem;
                line-height: 1.2;
            }

            .slide-counter {
                font-size: 0.65rem;
            }

            .toc-item {
                padding: 0.6rem 1rem 0.6rem 1.5rem;
                font-size: 0.8rem;
            }

            .toc-section-title {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
        }

        /* „Çπ„Éû„ÉõÁî®„Éé„Éº„Éà„Éë„Éç„É´Ë™øÊï¥ */
        @media (max-width: 768px) {
            .notes-panel {
                height: 50vh;
            }

            .notes-content {
                height: calc(50vh - 50px);
                font-size: 0.85rem;
            }
        }

        @media (max-width: 480px) {
            .notes-panel {
                height: 60vh;
            }

            .notes-content {
                height: calc(60vh - 50px);
                font-size: 0.8rem;
                padding: 0.75rem;
            }

            .notes-header {
                padding: 0.5rem 0.75rem;
            }

            .notes-header h3 {
                font-size: 0.8rem;
            }
        }

        /* „Çø„ÉÉ„ÉÅ„Éá„Éê„Ç§„ÇπÂêë„Åë */
        @media (hover: none) and (pointer: coarse) {
            .nav-btn {
                min-width: 48px;
                min-height: 48px;
            }

            .toc-item {
                min-height: 44px;
                display: flex;
                align-items: center;
            }

            .toc-section-title {
                min-height: 48px;
            }
        }

        /* ÂÖ®ÁîªÈù¢„É¢„Éº„Éâ */
        body.fullscreen-mode {
            overflow: hidden;
        }

        body.fullscreen-mode .header {
            display: none;
        }

        body.fullscreen-mode .sidebar {
            display: none;
        }

        body.fullscreen-mode .sidebar-overlay {
            display: none !important;
        }

        body.fullscreen-mode .container {
            height: 100vh;
        }

        body.fullscreen-mode .viewer {
            padding: 0;
            background: #000;
        }

        body.fullscreen-mode .slide-container {
            max-width: 100vw;
            max-height: 100vh;
            border-radius: 0;
            box-shadow: none;
        }

        body.fullscreen-mode .nav-controls {
            display: none;
        }

        body.fullscreen-mode .progress-bar {
            display: none;
        }

        body.fullscreen-mode .keyboard-hint {
            display: none;
        }

        body.fullscreen-mode .notes-panel {
            display: none;
        }

        /* ÂÖ®ÁîªÈù¢„É¢„Éº„Éâ„Åß„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Ç™„Éº„Éê„Éº„É¨„Ç§ */
        .fullscreen-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            z-index: 1000;
            pointer-events: none;
        }

        body.fullscreen-mode .fullscreen-nav {
            display: block;
        }

        .fullscreen-nav-area {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 20%;
            cursor: pointer;
            display: flex;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: auto;
        }

        .fullscreen-nav-area.nav-prev {
            left: 0;
            justify-content: flex-start;
            padding-left: 2rem;
        }

        .fullscreen-nav-area.nav-next {
            right: 0;
            justify-content: flex-end;
            padding-right: 2rem;
        }

        .fullscreen-nav-area:hover {
            opacity: 1;
            background: rgba(0,0,0,0.3);
        }

        .fullscreen-nav-area span {
            font-size: 3rem;
            color: #fff;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .fullscreen-exit {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            border: none;
            color: #fff;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            display: none;
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s;
        }

        body.fullscreen-mode .fullscreen-exit {
            display: block;
        }

        body.fullscreen-mode:hover .fullscreen-exit {
            opacity: 1;
        }

        .fullscreen-counter {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            display: none;
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s;
        }

        body.fullscreen-mode .fullscreen-counter {
            display: block;
        }

        body.fullscreen-mode:hover .fullscreen-counter {
            opacity: 1;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>AIÈßÜÂãïÈñãÁô∫„Çª„Éü„Éä„Éº</h1>
        <nav class="header-nav">
            <button onclick="toggleSidebar()" id="toc-btn">üìë ÁõÆÊ¨°</button>
            <button onclick="toggleNotes()" id="notes-btn" class="notes-btn">üìù „Éé„Éº„Éà</button>
            <button onclick="toggleFullscreen()" id="fullscreen-btn">üñ•Ô∏è ÂÖ®ÁîªÈù¢</button>
            <button onclick="selectSection(0)" data-section="0">01 ÂÖ•ÈñÄÁ∑®</button>
            <button onclick="selectSection(1)" data-section="1">02 Ë®≠Ë®àÁ∑®</button>
            <button onclick="selectSection(2)" data-section="2">03 ÂÆüË£ÖÁ∑®</button>
        </nav>
    </header>

    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>
    <div class="container">
        <aside class="sidebar" id="sidebar">
            <div id="toc-content">
                <div class="loading">
                    <div class="spinner"></div>
                    <p style="margin-top: 1rem;">Ë™≠„ÅøËæº„Åø‰∏≠...</p>
                </div>
            </div>
        </aside>

        <main class="viewer">
            <div class="slide-container" id="slide-container">
                <div class="loading">
                    <div class="spinner"></div>
                    <p style="margin-top: 1rem; color: #fff;">„Çπ„É©„Ç§„Éâ„ÇíË™≠„ÅøËæº„Åø‰∏≠...</p>
                </div>
            </div>

            <div class="nav-controls">
                <button class="nav-btn" id="prev-btn" onclick="prevSlide()">‚óÄ</button>
                <div class="slide-info">
                    <div class="slide-title" id="slide-title">-</div>
                    <div class="slide-counter" id="slide-counter">- / -</div>
                </div>
                <button class="nav-btn" id="next-btn" onclick="nextSlide()">‚ñ∂</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div class="keyboard-hint">
                ‚Üê ‚Üí „Ç≠„Éº„Åß„Éö„Éº„Ç∏ÈÄÅ„Çä / F: ÂÖ®ÁîªÈù¢ / N: „Éé„Éº„Éà
            </div>
        </main>
    </div>

    <!-- ÂÖ®ÁîªÈù¢„É¢„Éº„ÉâÁî®UI -->
    <div class="fullscreen-nav" id="fullscreen-nav">
        <div class="fullscreen-nav-area nav-prev" onclick="prevSlide()"><span>‚óÄ</span></div>
        <div class="fullscreen-nav-area nav-next" onclick="nextSlide()"><span>‚ñ∂</span></div>
    </div>
    <button class="fullscreen-exit" id="fullscreen-exit" onclick="exitFullscreen()">‚úï ÁµÇ‰∫Ü (Esc)</button>
    <div class="fullscreen-counter" id="fullscreen-counter">1 / 144</div>

    <!-- „Çπ„Éî„Éº„Ç´„Éº„Éé„Éº„Éà„Éë„Éç„É´ -->
    <div class="notes-panel" id="notes-panel">
        <div class="notes-header">
            <h3>üìù „Çπ„Éî„Éº„Ç´„Éº„Éé„Éº„Éà</h3>
            <button class="notes-close" onclick="toggleNotes()">‚úï</button>
        </div>
        <div class="notes-content" id="notes-content">
            „Éé„Éº„Éà„ÇíË™≠„ÅøËæº„Åø‰∏≠...
        </div>
    </div>

    <script>
        let manifest = [];
        let currentSection = 0;
        let currentSlide = 0;
        let allSlides = [];

        async function loadManifest() {
            try {
                const response = await fetch('manifest.json');
                manifest = await response.json();
                buildTOC();
                buildAllSlides();
                selectSection(0);
            } catch (error) {
                console.error('„Éû„Éã„Éï„Çß„Çπ„Éà„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó:', error);
                document.getElementById('toc-content').innerHTML = '<p style="padding: 1rem;">„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</p>';
            }
        }

        function buildAllSlides() {
            allSlides = [];
            manifest.forEach((section, sectionIndex) => {
                section.slides.forEach((slide, slideIndex) => {
                    allSlides.push({
                        ...slide,
                        sectionIndex,
                        sectionTitle: section.title,
                        globalIndex: allSlides.length
                    });
                });
            });
        }

        function buildTOC() {
            const tocContent = document.getElementById('toc-content');
            let html = '';

            manifest.forEach((section, sectionIndex) => {
                html += `
                    <div class="toc-section">
                        <div class="toc-section-title" onclick="toggleSection(${sectionIndex})">
                            <span>${section.title}</span>
                            <span id="arrow-${sectionIndex}">‚ñº</span>
                        </div>
                        <div class="toc-items" id="toc-items-${sectionIndex}">
                `;

                section.slides.forEach((slide, slideIndex) => {
                    const globalIndex = getGlobalIndex(sectionIndex, slideIndex);
                    const cssClass = slide.is_section ? 'toc-item section-title' : 'toc-item';
                    html += `
                        <div class="${cssClass}" data-global="${globalIndex}" onclick="goToSlide(${globalIndex})">
                            ${slide.title}
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            });

            tocContent.innerHTML = html;
        }

        function getGlobalIndex(sectionIndex, slideIndex) {
            let index = 0;
            for (let i = 0; i < sectionIndex; i++) {
                index += manifest[i].slides.length;
            }
            return index + slideIndex;
        }

        function toggleSection(sectionIndex) {
            const items = document.getElementById(`toc-items-${sectionIndex}`);
            const arrow = document.getElementById(`arrow-${sectionIndex}`);
            items.classList.toggle('expanded');
            arrow.textContent = items.classList.contains('expanded') ? '‚ñ≤' : '‚ñº';
        }

        function selectSection(sectionIndex) {
            // „Éò„ÉÉ„ÉÄ„Éº„Éú„Çø„É≥„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÇíÊõ¥Êñ∞
            document.querySelectorAll('.header-nav button[data-section]').forEach(btn => {
                btn.classList.remove('active');
            });
            const btn = document.querySelector(`.header-nav button[data-section="${sectionIndex}"]`);
            if (btn) btn.classList.add('active');

            // Ë©≤ÂΩì„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÊúÄÂàù„ÅÆ„Çπ„É©„Ç§„Éâ„Å∏
            const globalIndex = getGlobalIndex(sectionIndex, 0);
            goToSlide(globalIndex);

            // TOC„ÇíÂ±ïÈñã
            document.querySelectorAll('.toc-items').forEach((items, idx) => {
                if (idx === sectionIndex) {
                    items.classList.add('expanded');
                    document.getElementById(`arrow-${idx}`).textContent = '‚ñ≤';
                }
            });
        }

        function goToSlide(globalIndex) {
            if (globalIndex < 0 || globalIndex >= allSlides.length) return;

            currentSlide = globalIndex;
            const slide = allSlides[globalIndex];

            // ÁîªÂÉè„ÇíÊõ¥Êñ∞
            const container = document.getElementById('slide-container');
            container.innerHTML = `<img src="${slide.image}" alt="${slide.title}" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 16 9%22><rect fill=%22%23333%22 width=%2216%22 height=%229%22/><text x=%228%22 y=%225%22 fill=%22%23666%22 text-anchor=%22middle%22 font-size=%220.5%22>ÁîªÂÉè„Å™„Åó</text></svg>'">`;

            // ÊÉÖÂ†±„ÇíÊõ¥Êñ∞
            document.getElementById('slide-title').textContent = slide.title;
            document.getElementById('slide-counter').textContent = `${globalIndex + 1} / ${allSlides.length} (${slide.sectionTitle})`;

            // „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº
            const progress = ((globalIndex + 1) / allSlides.length) * 100;
            document.getElementById('progress-fill').style.width = `${progress}%`;

            // „Éú„Çø„É≥Áä∂ÊÖã
            document.getElementById('prev-btn').disabled = globalIndex === 0;
            document.getElementById('next-btn').disabled = globalIndex === allSlides.length - 1;

            // TOC„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã
            document.querySelectorAll('.toc-item').forEach(item => {
                item.classList.remove('active');
                if (parseInt(item.dataset.global) === globalIndex) {
                    item.classList.add('active');
                    item.scrollIntoView({ block: 'nearest' });
                }
            });

            // „Çª„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥„ÇíÊõ¥Êñ∞
            document.querySelectorAll('.header-nav button[data-section]').forEach(btn => {
                btn.classList.remove('active');
            });
            const sectionBtn = document.querySelector(`.header-nav button[data-section="${slide.sectionIndex}"]`);
            if (sectionBtn) sectionBtn.classList.add('active');

            // „Çπ„Éî„Éº„Ç´„Éº„Éé„Éº„Éà„ÇíÊõ¥Êñ∞
            updateNotes(slide);

            // ÂÖ®ÁîªÈù¢„É¢„Éº„Éâ„ÅÆ„Ç´„Ç¶„É≥„Çø„Éº„ÇíÊõ¥Êñ∞
            if (isFullscreen) {
                updateFullscreenCounter();
            }
        }

        function prevSlide() {
            goToSlide(currentSlide - 1);
        }

        function nextSlide() {
            goToSlide(currentSlide + 1);
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const isMobile = window.innerWidth <= 768;

            if (isMobile) {
                sidebar.classList.toggle('visible');
                overlay.classList.toggle('visible');
            } else {
                sidebar.classList.toggle('hidden');
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            sidebar.classList.remove('visible');
            overlay.classList.remove('visible');
        }

        // „Çπ„Éî„Éº„Ç´„Éº„Éé„Éº„ÉàÊ©üËÉΩ
        let notesVisible = false;

        function toggleNotes() {
            const panel = document.getElementById('notes-panel');
            const btn = document.getElementById('notes-btn');
            notesVisible = !notesVisible;
            panel.classList.toggle('visible', notesVisible);
            btn.classList.toggle('active', notesVisible);
        }

        function updateNotes(slide) {
            const content = document.getElementById('notes-content');
            if (slide && slide.notes) {
                content.textContent = slide.notes;
            } else {
                content.textContent = 'Ôºà„Åì„ÅÆ„Çπ„É©„Ç§„Éâ„Å´„ÅØ„Éé„Éº„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„ÇìÔºâ';
            }
        }

        // ÂÖ®ÁîªÈù¢„É¢„Éº„ÉâÊ©üËÉΩ
        let isFullscreen = false;

        function toggleFullscreen() {
            if (isFullscreen) {
                exitFullscreen();
            } else {
                enterFullscreen();
            }
        }

        function enterFullscreen() {
            isFullscreen = true;
            document.body.classList.add('fullscreen-mode');
            document.getElementById('fullscreen-btn').classList.add('active');
            updateFullscreenCounter();

            // „Éñ„É©„Ç¶„Ç∂„ÅÆÂÖ®ÁîªÈù¢API„Çí‰ΩøÁî®
            const elem = document.documentElement;
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.webkitRequestFullscreen) {
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) {
                elem.msRequestFullscreen();
            }
        }

        function exitFullscreen() {
            isFullscreen = false;
            document.body.classList.remove('fullscreen-mode');
            document.getElementById('fullscreen-btn').classList.remove('active');

            // „Éñ„É©„Ç¶„Ç∂„ÅÆÂÖ®ÁîªÈù¢„ÇíËß£Èô§
            if (document.exitFullscreen) {
                document.exitFullscreen().catch(() => {});
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
        }

        function updateFullscreenCounter() {
            const counter = document.getElementById('fullscreen-counter');
            counter.textContent = `${currentSlide + 1} / ${allSlides.length}`;
        }

        // „Éñ„É©„Ç¶„Ç∂„ÅÆÂÖ®ÁîªÈù¢Ëß£Èô§„ÇíÊ§úÁü•
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && isFullscreen) {
                isFullscreen = false;
                document.body.classList.remove('fullscreen-mode');
                document.getElementById('fullscreen-btn').classList.remove('active');
            }
        });

        // „Ç≠„Éº„Éú„Éº„Éâ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                case 'ArrowUp':
                    prevSlide();
                    break;
                case 'ArrowRight':
                case 'ArrowDown':
                case ' ':
                    e.preventDefault();
                    nextSlide();
                    break;
                case 'Home':
                    goToSlide(0);
                    break;
                case 'End':
                    goToSlide(allSlides.length - 1);
                    break;
                case 'n':
                case 'N':
                    toggleNotes();
                    break;
                case 'f':
                case 'F':
                    toggleFullscreen();
                    break;
                case 'Escape':
                    if (isFullscreen) {
                        exitFullscreen();
                    }
                    break;
            }
        });

        // „Çπ„ÉØ„Ç§„ÉóÂØæÂøú
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;

        const slideContainer = document.getElementById('slide-container');

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, { passive: true });

        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }, { passive: true });

        function handleSwipe() {
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            const minSwipeDistance = 50;

            // Ê®™ÊñπÂêë„ÅÆ„Çπ„ÉØ„Ç§„Éó„ÅåÁ∏¶ÊñπÂêë„Çà„ÇäÂ§ß„Åç„ÅÑÂ†¥Âêà„ÅÆ„ÅøÂá¶ÁêÜ
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                if (deltaX > 0) {
                    // Âè≥„Çπ„ÉØ„Ç§„Éó: Ââç„ÅÆ„Çπ„É©„Ç§„Éâ
                    prevSlide();
                } else {
                    // Â∑¶„Çπ„ÉØ„Ç§„Éó: Ê¨°„ÅÆ„Çπ„É©„Ç§„Éâ
                    nextSlide();
                }
            }
        }

        // TOC„Ç¢„Ç§„ÉÜ„É†„ÇØ„É™„ÉÉ„ÇØÊôÇ„Å´„É¢„Éê„Ç§„É´„Åß„ÅØ„Çµ„Ç§„Éâ„Éê„Éº„ÇíÈñâ„Åò„Çã
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('toc-item') && window.innerWidth <= 768) {
                closeSidebar();
            }
        });

        // ÂàùÊúüÂåñ
        loadManifest();
    </script>
</body>
</html>
